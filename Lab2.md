The **TFT\_eSPI** library is a widely adopted tool in the embedded systems world, especially among developers working with 32-bit microcontrollers like the **ESP32**. This lab will introduce you to core concepts in UI rendering, event-driven design, and SPI-based hardware control. You will also use **EEZ Studio**, a modern UI prototyping environment, and **LVGL (Light and Versatile Graphics Library)** to design interactive components.

All materials from previous lab are required!

## Part 1 â€“ Wiring

___

Begin by physically wiring your **ESP32** to the **TFT+Touch combo module**. Hereâ€™s the suggested pinout for a ILI9341 and XPT2046 combination:

<table><tbody><tr><td><strong><span>Display</span></strong></td><td><strong><span>Description</span></strong></td><td><span><strong>ESP32</strong> Pin</span></td></tr><tr><td><code>TFT_IRQ</code></td><td>Interrupt Pin</td><td>3</td></tr><tr><td><code>TFT_CS</code></td><td>Chip Select (TFT)</td><td>7</td></tr><tr><td><code>TFT_MOSI</code></td><td>Master Out (also TOUCH_DO)</td><td>6</td></tr><tr><td><code>TFT_MISO</code></td><td>Master In (also TOUCH_DIN)</td><td>5</td></tr><tr><td><code>TFT_SCLK</code></td><td>SPI Clock</td><td>4</td></tr><tr><td><code>TFT_DC</code></td><td>Data/Command Select</td><td>8</td></tr><tr><td><code>TFT_RST</code></td><td>Display Reset</td><td>10</td></tr><tr><td><code>TFT_LED</code></td><td>Backlight Power</td><td>3.3V</td></tr><tr><td><code>TOUCH_CS</code></td><td>Touch Chip Select</td><td>15</td></tr><tr><td><code>TOUCH_IRQ</code></td><td>Touch Interrupt</td><td>3</td></tr></tbody></table>

> ðŸ† Challenge
> 
> _Explain why MISO/MOSI/SCLK are shared between the display and touch controller. Include a short paragraph in your lab report about SPI multiplexing and its implications._

You should now have a **blank white screen** powered and ready.

## Part 2 â€“ UI Fun

___

1.  Download [this](https://github.com/litePhone/EEZ-Studio-Starter) Github repository as a ZIP
2.  **Configure the IDE**
    -   Open **Arduino IDE**, and go to **File > Preferences**, then set the _Sketchbook Location_ to the root of the unzipped folder (where `/ui/` and `/libraries/` are located).
3.  **Install dependencies**:
    -   Install **LVGL 8.3.11** (Manage Libraries)
    -   Install **TFT\_eSPI (latest version)**
    -   Reinstall **ESP32 Board version 2.0.11**
4.  **Download and set up EEZ Studio**:
    -   [Download here](https://www.envox.eu/)
    -   LVGL Version: 8.x
    -   Export Output Path: `/libraries/ui/`
    -   Change Build includes settings from `lvgl/lvgl.h` to `lvgl.h`

These Tutorials May Help:

<iframe title="Use EEZ Studio to Build an Arduino LVGL UI |&nbsp;nerdhut.de" width="500" height="281" src="https://www.youtube.com/embed/Jl83iMhHdBM?list=PLr5pt9vzODWAsB-d1C8or6jHfNZhbiplt" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen=""></iframe>

## Part 3 â€“ Build & Flash

___

**Compile the EEZ project** and generate the output files.

Overwrite the `ui.ino` in `/ui/` with the new one generated by EEZ Studio.

Open `ui.ino` in Arduino IDE and **upload** it to your ESP32.

You should now see your **home screen** on the display.

With this make a home screen with a button that leads to a â€œHello, World!â€ page.

## Part 4 â€“ Touchscreen

___

In your `ui.ino`, add the following code to enable touch input. This is **not plug-and-play**â€”read it carefully and understand each function; you will figure out where to place this code.

> â— Hint
> 
> The display must be calibrated

```
TFT_eSPI.begin();
TFT_eSPI.setRotation(0);

uint16_t calData[5] = {uint16_t, uint16_t, uint16_t, uint16_t, uint16_t};
TFT_eSPI.setTouch(calData);

void my_touchpad_read( lv_indev_drv_t * indev_driver, lv_indev_data_t * data )
{
    uint16_t touchX = 0, touchY = 0;

    bool touched = tft.getTouch(&touchX, &touchY, 600); 

    if (!touched)
    {
        data->state = LV_INDEV_STATE_REL;
    }
    else
    {
        data->state = LV_INDEV_STATE_PR;
        data->point.x = touchX;
        data->point.y = touchY;
    }
}
```

## Part 5 â€“ Speeeed!

___

Research other methods to wire a display to an ESP32 other than single-way SPI (1 Paragraph).

Choose one method and compare & contrast it with single-way SPI (1 Paragraph).

## Grading (100 Points)

-   Working Display with LED Backlight (20 Points)
-   Working Home Page (20 Points)
-   Working Hello, World! Page (20 Points)
-   Two Paragraphs on other Display Methods (20 Points)
-   Uploaded Lab Report Video (20 Points)